# 夢の氾濫（特殊演出）

書斎の窓から過去の夢が溢れ出す特殊演出。

---

## 画面構成

| 要素 | 説明 |
|------|------|
| 背景 | 書斎 |
| 窓 | トリガー要素 |
| 氾濫テキスト | 鏡文字（白字） |

---

## UI動作

### 発動

| 操作 | 動作 |
|------|------|
| 窓クリック | sfx_glass_warp.wav + 窓が歪む → 文字流入 |

### テキスト表示

| 操作 | 動作 |
|------|------|
| 初期表示 | 鏡文字として画面中央に表示 |
| ホバー / 長押し | 正像に反転 |

### 解除

| 操作 | 動作 |
|------|------|
| 背景クリック | 演出終了 → 書斎へ戻る |
| 1分放置 | 自動解除 → 書斎へ戻る |

---

## 生成ロジック

| 項目 | 説明 |
|------|------|
| ソース | 最大10冊の夢日記 |
| 分割 | 句点単位で分割 |
| 結合 | 5〜8文をランダム結合 |
| タグ優先 | 直近多用タグを優先抽出 |
| フォールバック | DB不足時はプリセット文章を混入（『遠くで鐘が鳴っている』等） |

---

## エラーハンドリング

| 状況 | 対応 |
|------|------|
| 通信エラー | 演出を開始せず書斎に留まる |

---

## API

### 氾濫テキスト取得

**エンドポイント**: `GET /api/v1/dreams/overflow`

**レスポンス（成功: 200）**:
```json
{
  "fragments": ["文字列1", "文字列2", "..."]
}
```

---

## 演出

`animations.md` 夢の氾濫（特殊演出）参照。

- 窓が歪む
- 断片文字の流入（感情彩色付き）
- 鏡文字表示

---

## 実装状況

- [ ] 窓クリックトリガー
- [ ] 氾濫テキスト生成API
- [ ] 鏡文字表示
- [ ] ホバー/長押しで正像反転
- [ ] 自動解除タイマー
- [ ] 演出（窓歪み・文字流入）
