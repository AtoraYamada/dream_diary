# トップページ（現実）

未ログイン状態のランディングページ。「夢が消える前に捕まえる」切迫感と没入感を優先。

---

## 画面構成

| 要素 | 説明 |
|------|------|
| 森の扉 | クリックで認証画面へ遷移 |
| 紙片（折りたたみ時） | 扉の傍らに落ちている小さな紙片 |
| 殴り書きの紙片（展開時） | 画面中央オーバーレイ、背景減光 |
| 音声推奨文 | 画面中央上部 |
| ミュートボタン | 右上 |

---

## UI動作

### 紙片の展開・収束

| 操作 | 動作 |
|------|------|
| 紙片クリック | 画面中央にオーバーレイ表示、背景減光 |
| 閉じるボタン | 紙片を折りたたみ状態に戻す |

### 殴り書きメモ入力

| 操作 | 動作 |
|------|------|
| テキスト入力 | 1文字ごとにLocalStorage自動保存 |
| フォーカス中 | 鉛筆カーソル + sfx_pencil_write.wav（ループ） |
| フォーカス解除 | カーソル・SE停止 |

**入力制限**: 最大2,000文字

### 扉クリック

| 操作 | 動作 |
|------|------|
| 扉クリック | ズーム + 瞬き演出 + sfx_door_open_heavy.wav → 認証画面へ |

---

## 音声対応（ブラウザ自動再生ポリシー）

ブラウザの自動再生制限に対応するため、扉クリック時に音声を有効化。

| 要素 | 説明 |
|------|------|
| 音声推奨文 | 画面中央上部に「音声ONでの体験を推奨します」等のメッセージ |
| ミュートボタン | 右上に配置、ON/OFF切替可能 |

### 音声有効化フロー

1. 初期状態: 音声OFF（ブラウザ制限のため）
2. ユーザーが扉をクリック
3. AudioContext を resume / 音声ファイルを unlock
4. sfx_door_open_heavy.wav 再生、以降SE再生可能

### ミュート状態管理

| キー | 値 | 説明 |
|------|-----|------|
| `audio_muted` | boolean | LocalStorageで永続化 |

---

## LocalStorage: 殴り書きメモ

詳細は `data.md` 参照。

| キー | 値 |
|------|-----|
| `scratchpad_memo` | メモ内容 |

### ライフサイクル

| イベント | 動作 |
|----------|------|
| 入力時 | LocalStorage自動保存 |
| ログイン/サインアップ | 保持したまま遷移 |
| 新規作成画面遷移時 | 殴り書きメモがあれば本文に自動入力 |
| 夢日記保存成功時 | LocalStorageから削除 |

### タイムスタンプ管理

最終入力日時を付与し、DBより新しければ復元を提案。

---

## 演出

`animations.md` トップページ 参照。

- 入力中（鉛筆カーソル + 筆記音）
- 扉クリック（ズーム + 瞬き）

---

## 実装状況

- [ ] 森の扉表示
- [ ] 紙片（折りたたみ）表示
- [ ] 殴り書きの紙片（展開）
- [ ] LocalStorage連携
- [ ] 鉛筆カーソル・筆記音
- [ ] 扉クリック遷移演出
- [ ] 音声推奨文・ミュートボタン
- [ ] ブラウザ音声有効化処理
